/**
 * ============================================================
 * üöó drive.h ‚Äî –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–æ–¥—É–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ—Ç–æ—Ä–∞–º–∏
 * ============================================================
 *
 * –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ PWM-—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 4 –º–æ—Ç–æ—Ä–∞–º–∏ —Ä–æ–≤–µ—Ä–∞.
 * –ù–∞ —Ç–µ–∫—É—â–µ–π –ø–ª–∞—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è LED-–∏–º–∏—Ç–∞—Ü–∏—è (—è—Ä–∫–æ—Å—Ç—å = —Å–∫–æ—Ä–æ—Å—Ç—å).
 *
 * –ú–æ—Ç–æ—Ä—ã:
 *   FL (Front Left)  ‚Äî –ø–µ—Ä–µ–¥–Ω–∏–π –ª–µ–≤—ã–π
 *   FR (Front Right) ‚Äî –ø–µ—Ä–µ–¥–Ω–∏–π –ø—Ä–∞–≤—ã–π
 *   RL (Rear Left)   ‚Äî –∑–∞–¥–Ω–∏–π –ª–µ–≤—ã–π
 *   RR (Rear Right)  ‚Äî –∑–∞–¥–Ω–∏–π –ø—Ä–∞–≤—ã–π
 *
 * –ò–Ω–¥–µ–∫—Å—ã –≤ enum Motor –ù–ï –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ (–∏–∑-–∑–∞ —Ä–∞–∑–≤–æ–¥–∫–∏ –ø–ª–∞—Ç—ã):
 *   RL=0, FR=1, FL=2, RR=3
 *
 * ============================================================
 */

#ifndef DRIVE_H
#define DRIVE_H

#include <Arduino.h>

// --- –ò–Ω–¥–µ–∫—Å—ã –º–æ—Ç–æ—Ä–æ–≤ (–ø–æ—Ä—è–¥–æ–∫ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ä–∞–∑–≤–æ–¥–∫–æ–π –ø–ª–∞—Ç—ã) ---
enum Motor : uint8_t {
    MOTOR_FL = 2,     // Front Left  (–ø–µ—Ä–µ–¥–Ω–∏–π –ª–µ–≤—ã–π)
    MOTOR_FR = 1,     // Front Right (–ø–µ—Ä–µ–¥–Ω–∏–π –ø—Ä–∞–≤—ã–π)
    MOTOR_RL = 0,     // Rear Left   (–∑–∞–¥–Ω–∏–π –ª–µ–≤—ã–π)
    MOTOR_RR = 3,     // Rear Right  (–∑–∞–¥–Ω–∏–π –ø—Ä–∞–≤—ã–π)
    MOTOR_COUNT = 4   // –û–±—â–µ–µ –∫–æ–ª-–≤–æ –º–æ—Ç–æ—Ä–æ–≤
};

// --- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤—Å–µ—Ö –º–æ—Ç–æ—Ä–æ–≤ ---
struct DriveState {
    uint8_t speed[MOTOR_COUNT];  // PWM —Å–∫–æ—Ä–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ –º–æ—Ç–æ—Ä–∞ (0-255)
};

// ============================================================
// API —Ñ—É–Ω–∫—Ü–∏–∏
// ============================================================

/** @brief –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è PWM –∫–∞–Ω–∞–ª–æ–≤. –í—ã–∑—ã–≤–∞—Ç—å –≤ setup(). */
void driveInit();

/** @brief –ü–æ–ª—É—á–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤—Å–µ—Ö –º–æ—Ç–æ—Ä–æ–≤ */
const DriveState& driveGetState();

/** @brief –ü–æ–ª—É—á–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–æ—Ç–æ—Ä–∞ (0-255) */
uint8_t driveGetSpeed(Motor motor);

/** @brief –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–æ—Ç–æ—Ä–∞ (0-255) */
void driveSetSpeed(Motor motor, uint8_t speed);

/** @brief –£–≤–µ–ª–∏—á–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å –º–æ—Ç–æ—Ä–∞ –Ω–∞ step (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10) */
void driveIncrement(Motor motor, uint8_t step = 10);

/** @brief –£–º–µ–Ω—å—à–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å –º–æ—Ç–æ—Ä–∞ –Ω–∞ step (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10) */
void driveDecrement(Motor motor, uint8_t step = 10);

// --- –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–≤–∏–∂–µ–Ω–∏—è ---
void driveStop();                    // –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –º–æ—Ç–æ—Ä—ã
void driveForward(uint8_t speed);    // –í–ø–µ—Ä—ë–¥: FL + FR
void driveBackward(uint8_t speed);   // –ù–∞–∑–∞–¥:  RL + RR
void driveTurnLeft(uint8_t speed);   // –ü–æ–≤–æ—Ä–æ—Ç –≤–ª–µ–≤–æ: —Ç–æ–ª—å–∫–æ –ø—Ä–∞–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞
void driveTurnRight(uint8_t speed);  // –ü–æ–≤–æ—Ä–æ—Ç –≤–ø—Ä–∞–≤–æ: —Ç–æ–ª—å–∫–æ –ª–µ–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞
void driveRotateLeft(uint8_t speed); // –¢–∞–Ω–∫–æ–≤—ã–π —Ä–∞–∑–≤–æ—Ä–æ—Ç –≤–ª–µ–≤–æ (FR + RL)
void driveRotateRight(uint8_t speed);// –¢–∞–Ω–∫–æ–≤—ã–π —Ä–∞–∑–≤–æ—Ä–æ—Ç –≤–ø—Ä–∞–≤–æ (FL + RR)

/** @brief –î–µ–º–æ —Ä–µ–∂–∏–º: –≤—ã–∑—ã–≤–∞—Ç—å –≤ loop(), –ø–µ—Ä–µ–±–∏—Ä–∞–µ—Ç 16 –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ */
void driveDemoUpdate();

#endif // DRIVE_H
