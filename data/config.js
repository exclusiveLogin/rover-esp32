/**
 * ============================================================
 * ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
 * ============================================================
 * 
 * –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ –¥–ª—è —É–¥–æ–±–Ω–æ–π –æ—Ç–ª–∞–¥–∫–∏.
 * 
 * ============================================================
 */

window.AppConfig = {
  // === –°–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ===
  
  // –ê–¥—Ä–µ—Å ESP32 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî —Ç–µ–∫—É—â–∏–π —Ö–æ—Å—Ç)
  // –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –æ—Ç–ª–∞–¥–∫–∏ –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å IP: "http://192.168.1.100"
  ESP32_HOST: location.hostname,
  
  // –ê–¥—Ä–µ—Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é = ESP32_HOST)
  // –ú–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä: "192.168.1.101" –∏–ª–∏ "camera.local"
  VIDEO_HOST: null,  // null = –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ESP32_HOST
  
  // –ü–æ—Ä—Ç –æ—Å–Ω–æ–≤–Ω–æ–≥–æ HTTP —Å–µ—Ä–≤–µ—Ä–∞
  HTTP_PORT: location.port || 80,
  
  // –ü–æ—Ä—Ç —Å—Ç—Ä–∏–º–∞
  STREAM_PORT: 81,
  
  // –ü—É—Ç—å –∫ —Å—Ç—Ä–∏–º—É (–¥–ª—è IP Webcam –∏ —Ç.–¥.)
  // ESP32: "/stream", IP Webcam Android: "/video", "/videofeed" –∏ —Ç.–¥.
  STREAM_PATH: '/stream',
  
  // === MJPEG Proxy (–æ–±—Ö–æ–¥ CORS) ===
  // –î–ª—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –±–µ–∑ CORS (IP Webcam, –≤–Ω–µ—à–Ω–∏–µ –∫–∞–º–µ—Ä—ã)
  // –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ dev-server!
  
  USE_PROXY: false,  // true = –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ dev-server
  
  // –ü–æ–ª–Ω—ã–π URL –≤–Ω–µ—à–Ω–µ–≥–æ —Å—Ç—Ä–∏–º–∞ (–¥–ª—è proxy)
  // –ü—Ä–∏–º–µ—Ä: "http://192.168.1.50:8080/video"
  EXTERNAL_STREAM_URL: null,//"http://192.168.31.135:8080",
  
  // === API Endpoints ===
  
  // –û—Å–Ω–æ–≤–Ω–æ–π API —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
  CONTROL_API: '/api/control',
  
  // –û—Ç–ª–∞–¥–æ—á–Ω—ã–π API –º–æ—Ç–æ—Ä–æ–≤
  DRIVE_API: '/api/drive',
  
  // API –∫–∞–º–µ—Ä—ã
  PHOTO_API: '/photo',
  LED_API: '/led',
  
  // API —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏ (–¥–ª—è OSD)
  STATUS_API: '/api/status',
  
  // === –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ===
  
  // ControlService –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
  CONTROL: {
    tickIntervalMs: 100,      // –ò–Ω—Ç–µ—Ä–≤–∞–ª sync tick (–º—Å)
    throttleMs: 1000,         // Throttle: heartbeat —Ä–∞–∑ –≤ 1 —Å–µ–∫
    deadzone: 20,             // –ú—ë—Ä—Ç–≤–∞—è –∑–æ–Ω–∞ –¥–ª—è X/Y
    maxValue: 255,            // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ X/Y
    expoX: 0,                 // Expo –∫—Ä–∏–≤–∞—è —Ä—É–ª—è (X): -1..+1 (0 = –ª–∏–Ω–µ–π–Ω–∞—è)
    expoY: 0,                 // Expo –∫—Ä–∏–≤–∞—è –≥–∞–∑–∞ (Y): -1..+1 (0 = –ª–∏–Ω–µ–π–Ω–∞—è)
    outputMinX: 0,            // –†—É–ª—å: –º–∏–Ω. PWM (–º—ë—Ä—Ç–≤–∞—è –∑–æ–Ω–∞ –º–æ—Ç–æ—Ä–∞). 0 = –±–µ–∑ —Ä–µ–º–∞–ø–∞
    outputMaxX: 255,          // –†—É–ª—å: –º–∞–∫—Å. PWM
    outputMinY: 0,            // –ì–∞–∑: –º–∏–Ω. PWM
    outputMaxY: 255,          // –ì–∞–∑: –º–∞–∫—Å. PWM
  },
  
  // === –î–∂–æ–π—Å—Ç–∏–∫–∏ ===
  
  JOYSTICK: {
    defaultRadius: 120,
    stickSize: 50,
    scale: 100,               // –ú–∞—Å—à—Ç–∞–± —Å—Ç–∏–∫–æ–≤, % (25..175, 100 = –±–∞–∑–∞)
  },
  
  // === UI ===
  
  UI: {
    reconnectDelay: 3000,     // –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å—Ç—Ä–∏–º–∞ (–º—Å)
    errorDisplayTime: 3000,   // –í—Ä–µ–º—è –ø–æ–∫–∞–∑–∞ –æ—à–∏–±–∫–∏ (–º—Å)
  },
  
  // === Computer Vision (OpenCV.js) ===
  
  CV: {
    enabled: false,           // –í–∫–ª—é—á–∏—Ç—å CV –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // üìê –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // –ú–µ–Ω—å—à–µ = –±—ã—Å—Ç—Ä–µ–µ, –±–æ–ª—å—à–µ = —Ç–æ—á–Ω–µ–µ
    //   320x240  ‚Äî –±—ã—Å—Ç—Ä–æ, –¥–ª—è —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
    //   640x480  ‚Äî –±–∞–ª–∞–Ω—Å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
    //   1280x720 ‚Äî –º–∞–∫—Å–∏–º—É–º —Ç–æ—á–Ω–æ—Å—Ç–∏
    processWidth: 640,
    processHeight: 480,
    processInterval: 100,     // –º—Å –º–µ–∂–¥—É –∫–∞–¥—Ä–∞–º–∏ (100 = 10 FPS)
    
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // üëÅÔ∏è –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–ª–æ—ë–≤ (—á–∏—Ç–∞–µ—Ç—Å—è initLayers –≤ script.js)
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    showHorizon: true,        // –°–ª–æ–π 3: –ª–∏–Ω–∏—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞ ‚Äî enabled –ø–æ —É–º–æ–ª—á.
    showGrid: true,           // –°–ª–æ–π 4: –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–Ω–∞—è —Å–µ—Ç–∫–∞ ‚Äî enabled –ø–æ —É–º–æ–ª—á.
    showWalls: true,          // –°–ª–æ–π 5: –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏ ‚Äî enabled –ø–æ —É–º–æ–ª—á.
    
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // üîç Canny edge detection
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // –ü–æ—Ä–æ–≥–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–Ω–∏–∂–∞—é—Ç—Å—è –¥–ª—è –ª—É—á—à–µ–π –¥–µ—Ç–µ–∫—Ü–∏–∏ —Ç—ë–º–Ω—ã—Ö –ª–∏–Ω–∏–π
    cannyLow: 50,             // –ù–∏–∂–Ω–∏–π –ø–æ—Ä–æ–≥ (min 20)
    cannyHigh: 150,           // –í–µ—Ä—Ö–Ω–∏–π –ø–æ—Ä–æ–≥ (min 60)
    
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // üìè Hough line detection
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ–¥ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
    houghThreshold: 50,       // –ú–∏–Ω–∏–º—É–º —Ç–æ—á–µ–∫ –Ω–∞ –ª–∏–Ω–∏–∏
    houghMinLength: 50,       // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ª–∏–Ω–∏–∏ (px)
    houghMaxGap: 10,          // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑—Ä—ã–≤ (px)
    
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // üìê –£–≥–ª—ã (–≥—Ä–∞–¥—É—Å—ã)
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    horizonMaxAngle: 45,      // –ú–∞–∫—Å. –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ (¬±45¬∞)
    wallAngleTolerance: 15,   // –î–æ–ø—É—Å–∫ –æ—Ç –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ –¥–ª—è —Å—Ç–µ–Ω
    
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // üéØ –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // –ê–ª–≥–æ—Ä–∏—Ç–º: —É–≥–æ–ª (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç—å) ‚Üí d (–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å) ‚Üí –º–µ–¥–∏–∞–Ω–∞
    clusterAngleTolerance: 8, // –î–æ–ø—É—Å–∫ –ø–æ —É–≥–ª—É –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ª–∏–Ω–∏–π
    // clusterToleranceD –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ = 3% –æ—Ç –¥–∏–∞–≥–æ–Ω–∞–ª–∏
    minClusterSegments: 1,    // –ú–∏–Ω–∏–º—É–º —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ
    smoothFrames: 5,          // –ë—É—Ñ–µ—Ä –º–µ–¥–∏–∞–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ (–∫–∞–¥—Ä—ã)
    
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // üé® –¶–≤–µ—Ç–∞
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    colors: {
      horizon: '#00FF00',     // –ó–µ–ª—ë–Ω—ã–π
      grid: 'rgba(0, 255, 255, 0.4)',  // Cyan –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π
      walls: '#FF6600'        // –û—Ä–∞–Ω–∂–µ–≤—ã–π
    }
  },
  
  // === Motion Detection (OpenCV.js) ===
  
  MOTION: {
    enabled: false,           // –í–∫–ª—é—á–∏—Ç—å Motion Detection –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // üìê –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    processWidth: 320,        // –®–∏—Ä–∏–Ω–∞ (px)
    processHeight: 240,       // –í—ã—Å–æ—Ç–∞ (px)
    processInterval: 100,     // –º—Å –º–µ–∂–¥—É –∫–∞–¥—Ä–∞–º–∏ (100 = 10 FPS)
    
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // üîç –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–µ—Ç–µ–∫—Ü–∏–∏
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    threshold: 25,            // –ü–æ—Ä–æ–≥ –±–∏–Ω–∞—Ä–∏–∑–∞—Ü–∏–∏ (0-255)
    minContourArea: 500,      // –ú–∏–Ω. –ø–ª–æ—â–∞–¥—å –∫–æ–Ω—Ç—É—Ä–∞ –¥–ª—è BB (px¬≤)
    dilateIterations: 2,      // –ò—Ç–µ—Ä–∞—Ü–∏–∏ dilate (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)
    blurSize: 5,              // –†–∞–∑–º–µ—Ä GaussianBlur —è–¥—Ä–∞
    
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // üëÅÔ∏è –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–ª–æ—ë–≤ (—á–∏—Ç–∞–µ—Ç—Å—è initLayers –≤ script.js)
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    showPixels: true,         // –°–ª–æ–π 0: –∫—Ä–∞—Å–Ω–∞—è –º–∞—Å–∫–∞ –ø–∏–∫—Å–µ–ª–µ–π ‚Äî enabled –ø–æ —É–º–æ–ª—á.
    showBoxes: true,          // –°–ª–æ–π 2: –∑–µ–ª—ë–Ω—ã–µ BB —Ä–∞–º–∫–∏ ‚Äî enabled –ø–æ —É–º–æ–ª—á.
    showContours: false,      // –°–ª–æ–π 1: –∫–æ–Ω—Ç—É—Ä—ã ‚Äî disabled –ø–æ —É–º–æ–ª—á.
    showDesaturate: false,    // UI: –¥–µ—Å–∞—Ç—É—Ä–∞—Ü–∏—è –≤–∏–¥–µ–æ (CSS filter)
    showOSD: true,            // UI: OSD –≤–∏–¥–∂–µ—Ç
  },
  
  // === Base Layer (–≤–∏–¥–µ–æ) ===

  BASE_LAYER: {
    visible: true,            // –ë–∞–∑–æ–≤—ã–π —Å–ª–æ–π (–≤–∏–¥–µ–æ) –≤–∏–¥–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  },

  // === Layer UI (—Ü–≤–µ—Ç–∞ —Ä–∞–º–æ–∫ –ø–ª–∏—Ç–æ–∫-–ø—Ä–µ–≤—å—é) ===

  LAYERS: {
    borderActive: '#4CAF50',           // –°–ª–æ–π –≤–∫–ª—é—á—ë–Ω (–∑–µ–ª—ë–Ω—ã–π)
    borderSolo:   '#FFC107',           // Solo-—Ä–µ–∂–∏–º (–∂—ë–ª—Ç—ã–π)
    borderOff:    'rgba(255,255,255,0.15)', // –°–ª–æ–π –≤—ã–∫–ª—é—á–µ–Ω (—Ç—É—Å–∫–ª—ã–π)
  },

  // === OSD (On-Screen Display) ===
  
  OSD: {
    enabled: true,            // OSD –≤–∫–ª—é—á—ë–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    pollIntervalSec: 5,       // –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ–ø—Ä–æ—Å–∞ (—Å–µ–∫—É–Ω–¥—ã, 1-10)
  },
  
  // === –£—Ç–∏–ª–∏—Ç—ã ===
  
  /**
   * –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–π URL —Å—Ç—Ä–∏–º–∞ (—Å —É—á—ë—Ç–æ–º proxy)
   */
  getStreamUrl() {
    // –ï—Å–ª–∏ –∑–∞–¥–∞–Ω –≤–Ω–µ—à–Ω–∏–π URL –∏ –≤–∫–ª—é—á—ë–Ω proxy
    if (this.USE_PROXY && this.EXTERNAL_STREAM_URL) {
      return `/proxy/stream?url=${encodeURIComponent(this.EXTERNAL_STREAM_URL)}`;
    }
    
    // –ü—Ä—è–º–æ–π URL
    const videoHost = this.VIDEO_HOST || this.ESP32_HOST;
    const streamPath = this.STREAM_PATH || '/stream';
    return `http://${videoHost}:${this.STREAM_PORT}${streamPath}`;
  },
  
  /**
   * –ü–æ–ª—É—á–∏—Ç—å –±–∞–∑–æ–≤—ã–π URL API
   */
  getApiBase() {
    const port = this.HTTP_PORT === 80 ? '' : `:${this.HTTP_PORT}`;
    return `http://${this.ESP32_HOST}${port}`;
  },
  
  /**
   * –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–π URL –¥–ª—è API endpoint
   */
  getApiUrl(endpoint) {
    return `${this.getApiBase()}${endpoint}`;
  },
  
  // === –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ (localStorage) ===
  
  /**
   * –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ localStorage
   * –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: AppConfig.save()
   */
  save() {
    const toSave = {
      ESP32_HOST: this.ESP32_HOST,
      VIDEO_HOST: this.VIDEO_HOST,
      STREAM_PORT: this.STREAM_PORT,
      STREAM_PATH: this.STREAM_PATH,
      USE_PROXY: this.USE_PROXY,
      EXTERNAL_STREAM_URL: this.EXTERNAL_STREAM_URL,
      CONTROL: { ...this.CONTROL },
      JOYSTICK: { ...this.JOYSTICK },
    };
    localStorage.setItem('AppConfig', JSON.stringify(toSave));
    console.log('‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã:', toSave);
  },
  
  /**
   * –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ localStorage
   * –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
   */
  load() {
    const saved = localStorage.getItem('AppConfig');
    if (saved) {
      try {
        const parsed = JSON.parse(saved);
        const networkKeys = ['ESP32_HOST', 'VIDEO_HOST', 'STREAM_PORT', 'STREAM_PATH', 'USE_PROXY', 'EXTERNAL_STREAM_URL'];
        networkKeys.forEach(k => { if (parsed[k] !== undefined) this[k] = parsed[k]; });
        if (parsed.CONTROL && typeof parsed.CONTROL === 'object') {
          Object.assign(this.CONTROL, parsed.CONTROL);
        }
        if (parsed.JOYSTICK && typeof parsed.JOYSTICK === 'object') {
          Object.assign(this.JOYSTICK, parsed.JOYSTICK);
        }
        console.log('üì¶ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ localStorage');
      } catch (e) {
        console.warn('‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫:', e);
      }
    }
  },
  
  /**
   * –°–±—Ä–æ—Å–∏—Ç—å –∫ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º
   */
  reset() {
    localStorage.removeItem('AppConfig');
    console.log('üóëÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
  },
};

// –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
window.AppConfig.load();
